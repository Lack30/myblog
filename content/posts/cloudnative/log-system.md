---
title: "日志系统架构设计和实践"
date: 2021-11-07T20:01:34+08:00
lastmod: 2021-11-07T20:01:34+08:00
draft: true
keywords: 
 - 架构
 - 理论
featuredImage: "https://raw.githubusercontent.com/xingyys/myblog/main/posts/images/20210926200427.png"
tags: 
 - 笔记
categories: 
 - 云原生
author: "Lack"
---

## 日志系统设计原则

### 为什么需要日志

问题定位流程
- 发现问题
- 描述现象
- 定位原因

日志历史
- 单机时代
- 集中化存储
- 统一存储、统一处理、分布式查询

### 日志的意义
可观测性
- 业务、运营、BI、审计、安全
- 数字化、智能化

好的日志
- 了解系统状态
- 快速定位
- 发现系统瓶颈
- 发现潜在风险

不好的日志
- 黑盒
- 浪费时间、浪费精力
- 无从下手进行优化
- 监控、预警失灵

### 日志的分类
诊断日志
- 请求参数
- 启动参数
- 资源操作详情
- 配置变更

统计日志
- 访问统计
- 资源统计

审计日志

### 输出日志的原则

不多

- 不要在日志中记录无用的信息
- 无有效消息
- 单纯的堆栈信息
- 为了调试增加的临时信息

不少

- 从日志中得到所有需要的信息
- 明确显示程序执行逻辑
- 显示代码是否按照期望运行
- 确定当前服务处理状态
- 异常逻辑状态
- 配置参数加载

### 输出日志容易遗漏的数据

配置参数
- 内存设置
- 域名设置
- 数据库设置
- 进程池设置

定时任务
- 任务启动时间
- 任务结束时间
- 处理的任务ID
- 任务简要描述

异常逻辑
- 失败原因
- 失败节点
- 容错措施

关键参数
- 调用参数
- 判断逻辑

### 输出日志如何确定级别
DEBUG
- 精确的记录
- 还原过程
- 问题诊断
- 可读性

INFO
- 服务初始化
- 服务开始结束
- 服务运行状态

WARN
- 可能的隐患
- 提醒关注

ERROR
- 影响业务
- 马上处理
- 服务自身无法纠正
- 崩溃边缘

FATAL
- 已经崩溃
- 系统错误


## 如何规划日志系统

## 日志系统最佳实践
                                                   